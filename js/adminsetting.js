jQuery(document).ready((function(){$("#side-menu-lead-create").on("click",(function(a){var e=$(this).attr("name"),t=$("#aaochat_lead_name").val(),s=$("#aaochat_lead_email").val(),l=$("#aaochat_lead_phone_contry_code").val(),i=$("#aaochat_lead_phone").val(),d=$("#aaochat_lead_country").val(),r=$("#aaochat_lead_domain_identifier").val(),o=$("#aaochat_lead_organization").val(),n=$("#aaochat_lead_organization_address").val(),c=$("#aaochat_lead_organization_siteurl").val();return $(this).attr("disabled","disabled"),""==t?(alert("Please enter full name"),$(this).removeAttr("disabled","disabled"),!1):""==s?(alert("Please enter email"),$(this).removeAttr("disabled","disabled"),!1):""!=s&&null==s.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)?(alert("Please enter valid email"),$(this).removeAttr("disabled","disabled"),!1):""==l?(alert("Please enter phone country code"),$(this).removeAttr("disabled","disabled"),!1):""==i?(alert("Please enter phone number"),$(this).removeAttr("disabled","disabled"),!1):""==d?(alert("Please enter country"),$(this).removeAttr("disabled","disabled"),!1):""==r?(alert("Please enter domain name"),$(this).removeAttr("disabled","disabled"),!1):r.length>20?(alert("domain name must be less than 20 characters."),$(this).removeAttr("disabled","disabled"),!1):0==/^[a-zA-Z0-9\-\_\.]+$/i.test(r)?(alert("Please enter valid domain name"),$(this).removeAttr("disabled","disabled"),!1):""==o?(alert("Please enter organization"),$(this).removeAttr("disabled","disabled"),!1):""==n?(alert("Please enter organization address"),$(this).removeAttr("disabled","disabled"),!1):""==c?(alert("Please enter organization site url"),$(this).removeAttr("disabled","disabled"),!1):($(".aaochat_loader").show(),void $.ajax({url:OC.generateUrl("/apps/aaochat/createlead"),type:"POST",data:{action_name:e,aaochat_lead_name:t,aaochat_lead_email:s,aaochat_lead_phone_contry_code:l,aaochat_lead_phone:i,aaochat_lead_country:d,aaochat_lead_domain_identifier:r,aaochat_lead_organization:o,aaochat_lead_organization_address:n,aaochat_lead_organization_siteurl:c},success:function(a){if(console.log(a),"success"==a.status)if("register"==e){var t=a.data,s=t._id,l=(t.name,t.email,t.phoneNo,t.organization,t.status);""==s||$(this).removeAttr("disabled","disabled"),$("#aaochat_lead_status").val(l),$("#aaochat_lead_id").val(s),$("#aaochat_lead_status_msg").html(a.message),$("#aaochat-lead .side-menu-setting-table input").attr("readonly","readonly"),$("#aaochat-lead .side-menu-setting-table textarea").attr("disabled","disabled"),$("#aaochat-lead .side-menu-setting-table select").attr("disabled","disabled"),setTimeout((function(){$(".aaochat_loader").hide(),$("#activate-licence").css({display:"block"})}),1500)}else $("#aaochat_lead_status_msg").html("Your detail updated successfully."),$("#aaochat-lead input#aaochat_lead_domain_identifier").attr("readonly","readonly"),setTimeout((function(){$("#side-menu-lead-create").removeAttr("disabled","disabled"),$(".aaochat_loader").hide(),$("#activate-licence").css({display:"block"})}),1500);else void 0!==a.message&&(alert(a.message),$("#side-menu-lead-create").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())},error:function(a,e,t){$("#side-menu-lead-create").removeAttr("disabled","disabled"),$(".aaochat_loader").hide()}}))})),$("#side-menu-lead-status").on("click",(function(a){var e=$("#aaochat_lead_id").val();if(""==e)return alert("We didn't find your reference. Please try later or contact administrator."),!1;$(".aaochat_loader").show(),$.ajax({url:OC.generateUrl("/apps/aaochat/leadstatus"),type:"POST",data:{aaochat_lead_id:e},success:function(a){if("success"==a.status){var e=a.data.status;$("#aaochat_lead_status").val(e),"pending"==e?($(".aaochat_loader").hide(),$("#aaochat_lead_status_msg").html("Your profile is in review. You will receive the license key soon.")):setTimeout((function(){window.location.reload()}),1500)}else void 0!==a.message&&(alert(a.message),$(".aaochat_loader").hide())}})})),$("#side-menu-license-activate").on("click",(function(a){var e=$("#aaochat_license_key").val();if($(this).attr("disabled","disabled"),""==e)return alert("Please enter license key"),$(this).removeAttr("disabled","disabled"),!1;$(".aaochat_loader").show(),$.ajax({url:OC.generateUrl("/apps/aaochat/activatelicense"),type:"POST",data:{licenseKey:e},success:function(a){if("success"==a.status){var e=(x=a.data)._id,t=x.clientId,s=x.licenseKey,l=x.serverDetails,i=l.serverInstanceType,d=l.url,r=l.fileServerUrl,o=l.storageSize,n=l._id,c=x.status,_=x.activationDate,h=x.ipAddress,v="no";"active"==c&&(v="yes"),$("#aaochat_client_id").val(t),$("#aaochat_license_key").val(s),$("#aaochat_is_license_valid").val(v),$("#aaochat_ser_instance_type").val(i),$("#aaochat_ser_url").val(d),$("#aaochat_ser_file_server_url").val(r),$("#aaochat_ser_storage_size").val(o),$("#aaochat_ser_id").val(n),$("#aaochat_license_status").val(c),$("#aaochat_license_id").val(e),$("#aaochat_activation_date").val(_),$("#aaochat_ipaddress").val(h),$(".aaochat-setting-extra-fields").removeClass("hide"),$(".aaochat-setting-extra-fields").addClass("show");var u=x.localStorageData,m=u.ncUserAuthKey,b=u.aaochatServerUrl,g=u.aaochatFileServerUrl;if("undefined"!=typeof Storage){var f=localStorage.getItem("ngStorage-AuthKey");void 0===m&&null==m||m==f||(localStorage.setItem("ngStorage-AuthKey",m),localStorage.setItem("nextcloud-AaoChatServerURL",b),localStorage.setItem("nextcloud-AaoChatFileServerURL",g))}setTimeout((function(){window.location.reload()}),3e4)}else if("error"==a.status){var x;void 0!==a.data?"inactive"==(x=a.data).serverStatus&&(alert("Oops! It appears that the license key you are attempting to use has expired. To continue using Aao Chat, kindly submit a new registration request."),$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide(),localStorage.removeItem("ngStorage-AuthKey"),localStorage.removeItem("nextcloud-AaoChatServerURL"),localStorage.removeItem("nextcloud-AaoChatFileServerURL")):void 0!==a.message&&(alert(a.message),$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())}else void 0!==a.message&&(alert(a.message),$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())},error:function(a,e,t){$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide()}})})),$("#side-menu-license-surrender").on("click",(function(a){var e=$("#aaochat_license_key").val();if(""==e)return alert("Please enter license key"),$(this).removeAttr("disabled","disabled"),!1;$(this).attr("disabled","disabled"),$(".aaochat_loader").show(),$.ajax({url:OC.generateUrl("/apps/aaochat/surrenderlicense"),type:"POST",data:{licenseKey:e},success:function(a){if("success"==a.status){var e=a.data,t=e._id,s=e.clientId,l=e.licenseKey,i=e.serverDetails,d=i.serverInstanceType,r=i.url,o=i.fileServerUrl,n=i.storageSize,c=i._id,_=e.status,h=e.activationDate,v=e.ipAddress,u="no";"active"==_&&(u="yes"),$("#aaochat_client_id").val(s),$("#aaochat_license_key").val(l),$("#aaochat_is_license_valid").val(u),$("#aaochat_ser_instance_type").val(d),$("#aaochat_ser_url").val(r),$("#aaochat_ser_file_server_url").val(o),$("#aaochat_ser_storage_size").val(n),$("#aaochat_ser_id").val(c),$("#aaochat_license_status").val(_),$("#aaochat_license_id").val(t),$("#aaochat_activation_date").val(h),$("#aaochat_ipaddress").val(v),$(".aaochat-setting-extra-fields").removeClass("hide"),$(".aaochat-setting-extra-fields").addClass("show"),setTimeout((function(){window.location.reload()}),5e3)}else void 0!==a.message&&(alert(a.message),$("#side-menu-license-surrender").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())},error:function(a,e,t){$("#side-menu-license-surrender").removeAttr("disabled","disabled"),$(".aaochat_loader").hide()}})}))}));
//# sourceMappingURL=adminsetting.js.map