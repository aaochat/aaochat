jQuery(document).ready((function(){$("#side-menu-lead-create").on("click",(function(e){var a=$(this).attr("name"),t=$("#aaochat_lead_name").val(),s=$("#aaochat_lead_email").val(),i=$("#aaochat_lead_phone_contry_code").val(),l=$("#aaochat_lead_phone").val(),r=$("#aaochat_lead_country").val(),d=$("#aaochat_lead_domain_identifier").val(),o=$("#aaochat_lead_organization").val(),n=$("#aaochat_lead_organization_address").val(),c=$("#aaochat_lead_organization_siteurl").val();return $(this).attr("disabled","disabled"),""==t?(alert("Please enter full name"),$(this).removeAttr("disabled","disabled"),!1):""==s?(alert("Please enter email"),$(this).removeAttr("disabled","disabled"),!1):""!=s&&null==s.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)?(alert("Please enter valid email"),$(this).removeAttr("disabled","disabled"),!1):""==i?(alert("Please enter phone country code"),$(this).removeAttr("disabled","disabled"),!1):""==l?(alert("Please enter phone number"),$(this).removeAttr("disabled","disabled"),!1):""==r?(alert("Please enter country"),$(this).removeAttr("disabled","disabled"),!1):""==d?(alert("Please enter domain name"),$(this).removeAttr("disabled","disabled"),!1):0==/^[a-zA-Z0-9\-\_\.]+$/i.test(d)?(alert("Please enter valid domain name"),$(this).removeAttr("disabled","disabled"),!1):""==o?(alert("Please enter organization"),$(this).removeAttr("disabled","disabled"),!1):""==n?(alert("Please enter organization address"),$(this).removeAttr("disabled","disabled"),!1):""==c?(alert("Please enter organization site url"),$(this).removeAttr("disabled","disabled"),!1):($(".aaochat_loader").show(),void $.ajax({url:OC.generateUrl("/apps/aaochat/createlead"),type:"POST",data:{action_name:a,aaochat_lead_name:t,aaochat_lead_email:s,aaochat_lead_phone_contry_code:i,aaochat_lead_phone:l,aaochat_lead_country:r,aaochat_lead_domain_identifier:d,aaochat_lead_organization:o,aaochat_lead_organization_address:n,aaochat_lead_organization_siteurl:c},success:function(e){if(console.log(e),"success"==e.status)if("register"==a){var t=e.data,s=t._id,i=(t.name,t.email,t.phoneNo,t.organization,t.status);""==s||$(this).removeAttr("disabled","disabled"),$("#aaochat_lead_status").val(i),$("#aaochat_lead_id").val(s),$("#aaochat_lead_status_msg").html("You will receive the license key in your registered email address within 24 hours. <br/>Once you receive the license key, please enter below and activate it."),$("#aaochat-lead .side-menu-setting-table input").attr("readonly","readonly"),$("#aaochat-lead .side-menu-setting-table textarea").attr("textarea","textarea"),$("#aaochat-lead .side-menu-setting-table select").attr("disabled","disabled"),setTimeout((function(){$(".aaochat_loader").hide(),$("#activate-licence").css({display:"block"})}),1500)}else $("#aaochat_lead_status_msg").html("Your detail updated successfully."),$("#aaochat-lead input#aaochat_lead_domain_identifier").attr("readonly","readonly"),setTimeout((function(){$("#side-menu-lead-create").removeAttr("disabled","disabled"),$(".aaochat_loader").hide(),$("#activate-licence").css({display:"block"})}),1500);else void 0!==e.message&&(alert(e.message),$("#side-menu-lead-create").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())},error:function(e,a,t){$("#side-menu-lead-create").removeAttr("disabled","disabled"),$(".aaochat_loader").hide()}}))})),$("#side-menu-lead-status").on("click",(function(e){var a=$("#aaochat_lead_id").val();if(""==a)return alert("We didn't find your reference. Please try later or contact administrator."),!1;$(".aaochat_loader").show(),$.ajax({url:OC.generateUrl("/apps/aaochat/leadstatus"),type:"POST",data:{aaochat_lead_id:a},success:function(e){if("success"==e.status){var a=e.data.status;$("#aaochat_lead_status").val(a),"pending"==a?($(".aaochat_loader").hide(),$("#aaochat_lead_status_msg").html("Your profile is in review. You will receive the license key soon.")):setTimeout((function(){window.location.reload()}),1500)}else void 0!==e.message&&(alert(e.message),$(".aaochat_loader").hide())}})})),$("#side-menu-license-activate").on("click",(function(e){var a=$("#aaochat_license_key").val();if($(this).attr("disabled","disabled"),""==a)return alert("Please enter license key"),$(this).removeAttr("disabled","disabled"),!1;$(".aaochat_loader").show(),$.ajax({url:OC.generateUrl("/apps/aaochat/activatelicense"),type:"POST",data:{licenseKey:a},success:function(e){if("success"==e.status){var a=(y=e.data)._id,t=y.clientId,s=y.licenseKey,i=y.serverDetails,l=i.serverInstanceType,r=i.url,d=i.fileServerUrl,o=i.storageSize,n=i._id,c=y.status,_=y.activationDate,h=y.ipAddress,u="no";"active"==c&&(u="yes"),$("#aaochat_client_id").val(t),$("#aaochat_license_key").val(s),$("#aaochat_is_license_valid").val(u),$("#aaochat_ser_instance_type").val(l),$("#aaochat_ser_url").val(r),$("#aaochat_ser_file_server_url").val(d),$("#aaochat_ser_storage_size").val(o),$("#aaochat_ser_id").val(n),$("#aaochat_license_status").val(c),$("#aaochat_license_id").val(a),$("#aaochat_activation_date").val(_),$("#aaochat_ipaddress").val(h),$(".aaochat-setting-extra-fields").removeClass("hide"),$(".aaochat-setting-extra-fields").addClass("show");var v=y.localStorageData,m=v.ncUserAuthKey,b=v.aaochatServerUrl,g=v.aaochatFileServerUrl;if("undefined"!=typeof Storage){var f=localStorage.getItem("ngStorage-AuthKey");void 0===m&&null==m||m==f||(localStorage.setItem("ngStorage-AuthKey",m),localStorage.setItem("nextcloud-AaoChatServerURL",b),localStorage.setItem("nextcloud-AaoChatFileServerURL",g))}setTimeout((function(){window.location.reload()}),3e4)}else if("error"==e.status){var y;void 0!==e.data?"inactive"==(y=e.data).serverStatus&&(alert("Oops! It appears that the license key you are attempting to use has expired. To continue using Aao Business Chat, kindly submit a new registration request."),$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide(),localStorage.removeItem("ngStorage-AuthKey"),localStorage.removeItem("nextcloud-AaoChatServerURL"),localStorage.removeItem("nextcloud-AaoChatFileServerURL")):void 0!==e.message&&(alert(e.message),$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())}else void 0!==e.message&&(alert(e.message),$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())},error:function(e,a,t){$("#side-menu-license-activate").removeAttr("disabled","disabled"),$(".aaochat_loader").hide()}})})),$("#side-menu-license-surrender").on("click",(function(e){var a=$("#aaochat_license_key").val();if(""==a)return alert("Please enter license key"),$(this).removeAttr("disabled","disabled"),!1;$(this).attr("disabled","disabled"),$(".aaochat_loader").show(),$.ajax({url:OC.generateUrl("/apps/aaochat/surrenderlicense"),type:"POST",data:{licenseKey:a},success:function(e){if("success"==e.status){var a=e.data,t=a._id,s=a.clientId,i=a.licenseKey,l=a.serverDetails,r=l.serverInstanceType,d=l.url,o=l.fileServerUrl,n=l.storageSize,c=l._id,_=a.status,h=a.activationDate,u=a.ipAddress,v="no";"active"==_&&(v="yes"),$("#aaochat_client_id").val(s),$("#aaochat_license_key").val(i),$("#aaochat_is_license_valid").val(v),$("#aaochat_ser_instance_type").val(r),$("#aaochat_ser_url").val(d),$("#aaochat_ser_file_server_url").val(o),$("#aaochat_ser_storage_size").val(n),$("#aaochat_ser_id").val(c),$("#aaochat_license_status").val(_),$("#aaochat_license_id").val(t),$("#aaochat_activation_date").val(h),$("#aaochat_ipaddress").val(u),$(".aaochat-setting-extra-fields").removeClass("hide"),$(".aaochat-setting-extra-fields").addClass("show"),setTimeout((function(){window.location.reload()}),5e3)}else void 0!==e.message&&(alert(e.message),$("#side-menu-license-surrender").removeAttr("disabled","disabled"),$(".aaochat_loader").hide())},error:function(e,a,t){$("#side-menu-license-surrender").removeAttr("disabled","disabled"),$(".aaochat_loader").hide()}})}))}));
//# sourceMappingURL=adminsetting.js.map